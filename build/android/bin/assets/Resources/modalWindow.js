Ti.include("Home.js");
exports.modalWin=function(){var e=Titanium.App.Properties.getString("MobileNumber"),f=Ti.UI.createWindow({backgroundColor:"#008B8B",opacity:0.5,fullscreen:!0,id:"popupWin"}),d=Ti.UI.createView({width:"50%",height:"40%",backgroundColor:"#008B8B",borderRadius:5,borderColor:"white",borderWidth:3}),g=Titanium.UI.createButton({title:"",backgroundImage:"images/camera.png",top:"5%",left:"5%",height:"15%",width:"90%",id:"Custom Button"}),h=Titanium.UI.createButton({title:"",backgroundImage:"images/gallery.png",top:"25%",
left:"5%",height:"15%",width:"90%",id:"Custom Button"}),i=Titanium.UI.createButton({title:"",backgroundImage:"images/removeimage.png",top:"45%",left:"5%",height:"15%",width:"90%",id:"Custom Button"});i.addEventListener("click",function(){var b="http://www.visitindia.com/PeopleTracker/RemovePic.php?mno="+e,c=Ti.Network.createHTTPClient({onload:function(){var a=this.responseText;Ti.API.info(this.responseText);a=a.trim();a=a.ltrim();a=a.rtrim();if(a.charAt(0)=="S"){var a=a.split("*~*"),b=Ti.UI.currentWindow;
Ti.App.fireEvent("updateImage",{imageData:a[1]});b.close()}else alert("there is some error in the image file you are uploading. Please check it and try again")},onerror:function(){},timeout:5E3});c.open("GET",b);c.send()});g.addEventListener("click",function(){Titanium.Media.showCamera({success:function(b){var b=b.media.imageAsResized(80,80),c=Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,"camera_photo.png");c.write(b);b={file:c.read(),name:"camera_photo.png",mno:e};xhr=
Titanium.Network.createHTTPClient();xhr.open("POST","http://www.visitindia.com/PeopleTracker/UploadPic.php");xhr.setRequestHeader("contentType","multipart/form-data");xhr.send(b);xhr.onload=function(){var a=this.responseText,a=a.trim(),a=a.ltrim(),a=a.rtrim();if(a.charAt(0)=="S"){var a=a.split("*~*"),b=Ti.UI.currentWindow;Ti.App.fireEvent("updateImage",{imageData:a[1]});b.close()}else alert("there is some error in the image file you are uploading. Please check it and try again")}},cancel:function(){},
error:function(b){var c=Titanium.UI.createAlertDialog({title:"Camera"});b.code==Titanium.Media.NO_CAMERA?c.setMessage("Device does not have video recording capabilities"):c.setMessage("Unexpected error: "+b.code);c.show()}})});h.addEventListener("click",function(){Titanium.Media.openPhotoGallery({success:function(b){var b=b.media.imageAsResized(80,80),c=Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,"camera_photo.png");c.write(b);b={file:c.read(),name:"camera_photo.png",
mno:e};xhr=Titanium.Network.createHTTPClient();xhr.open("POST","http://www.visitindia.com/PeopleTracker/UploadPic.php");xhr.setRequestHeader("contentType","multipart/form-data");xhr.send(b);xhr.onload=function(){var a=this.responseText;Ti.API.info(this.responseText);a=a.trim();a=a.ltrim();a=a.rtrim();if(a.charAt(0)=="S"){var a=a.split("*~*"),b=Ti.UI.currentWindow;Ti.App.fireEvent("updateImage",{imageData:a[1]});b.close()}else alert("there is some error in the image file you are uploading. Please check it and try again")}}})});
var j=Titanium.UI.createButton({title:"",backgroundImage:"images/close.png",top:"65%",left:"5%",height:"15%",width:"90%",id:"Custom Button"});j.addEventListener("click",function(){f.close()});d.add(j);d.add(g);d.add(h);d.add(i);f.add(d);return f};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};
